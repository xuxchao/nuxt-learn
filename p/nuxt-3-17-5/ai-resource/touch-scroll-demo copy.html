<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Anime.js 触摸滚动模拟</title>
    <!-- 引入Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- 引入Font Awesome -->
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <!-- 引入anime.js -->
    <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js"></script>
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#3B82F6',
                        secondary: '#10B981',
                        dark: '#1E293B',
                        light: '#F8FAFC'
                    },
                    fontFamily: {
                        sans: ['Inter', 'system-ui', 'sans-serif'],
                    },
                }
            }
        }
    </script>
    
    <style type="text/tailwindcss">
        @layer utilities {
            .content-auto {
                content-visibility: auto;
            }
            .phone-frame {
                width: 320px;
                height: 640px;
                border: 16px solid #1E293B;
                border-radius: 40px;
                position: relative;
                overflow: hidden;
                box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            }
            .phone-frame::before {
                content: '';
                position: absolute;
                top: 0;
                left: 50%;
                transform: translateX(-50%);
                width: 160px;
                height: 24px;
                background-color: #1E293B;
                border-bottom-left-radius: 12px;
                border-bottom-right-radius: 12px;
            }
            .scroll-content {
                position: absolute;
                top: 0;
                left: 0;
                width: 100%;
            }
        }
    </style>
</head>
<body class="bg-gray-100 min-h-screen flex items-center justify-center p-4 font-sans">
    <div class="max-w-md mx-auto">
        <h1 class="text-[clamp(1.5rem,3vw,2.5rem)] font-bold text-center text-dark mb-8">
            <i class="fa fa-mobile text-primary mr-2" aria-hidden="true"></i>
            触摸滚动模拟
        </h1>
        
        <!-- 手机模拟器 -->
        <div class="phone-frame mx-auto">
            <!-- 可滚动内容容器 -->
            <div id="scrollContainer" class="h-full overflow-hidden">
                <!-- 实际滚动内容 -->
                <div id="scrollContent" class="scroll-content bg-light">
                    <!-- 头部 -->
                    <div class="bg-primary text-white p-5 relative">
                        <h2 class="text-xl font-bold">探索页面</h2>
                        <p class="text-sm opacity-90 mt-1">向上滑动查看更多内容</p>
                    </div>
                    
                    <!-- 内容区域 -->
                    <div class="p-4">
                        <!-- 卡片1 -->
                        <div class="bg-white rounded-xl shadow-md p-4 mb-4 transform transition hover:shadow-lg">
                            <img src="https://picsum.photos/300/200?random=1" alt="风景图片1" class="w-full h-48 object-cover rounded-lg mb-3">
                            <h3 class="font-bold text-lg">自然风光</h3>
                            <p class="text-gray-600 text-sm">探索大自然的美丽景色，感受大自然的魅力与力量。</p>
                        </div>
                        
                        <!-- 卡片2 -->
                        <div class="bg-white rounded-xl shadow-md p-4 mb-4 transform transition hover:shadow-lg">
                            <img src="https://picsum.photos/300/200?random=2" alt="城市建筑图片" class="w-full h-48 object-cover rounded-lg mb-3">
                            <h3 class="font-bold text-lg">城市建筑</h3>
                            <p class="text-gray-600 text-sm">现代都市的建筑风格，展现人类文明的进步与创造力。</p>
                        </div>
                        
                        <!-- 卡片3 -->
                        <div class="bg-white rounded-xl shadow-md p-4 mb-4 transform transition hover:shadow-lg">
                            <img src="https://picsum.photos/300/200?random=3" alt="海洋生物图片" class="w-full h-48 object-cover rounded-lg mb-3">
                            <h3 class="font-bold text-lg">海洋世界</h3>
                            <p class="text-gray-600 text-sm">神秘的海底世界，蕴藏着无数未知的生物与秘密。</p>
                        </div>
                        
                        <!-- 卡片4 -->
                        <div class="bg-white rounded-xl shadow-md p-4 mb-4 transform transition hover:shadow-lg">
                            <img src="https://picsum.photos/300/200?random=4" alt="山脉图片" class="w-full h-48 object-cover rounded-lg mb-3">
                            <h3 class="font-bold text-lg">壮丽山脉</h3>
                            <p class="text-gray-600 text-sm">高耸入云的山脉，见证着地球亿万年的变迁。</p>
                        </div>
                        
                        <!-- 卡片5 -->
                        <div class="bg-white rounded-xl shadow-md p-4 mb-4 transform transition hover:shadow-lg">
                            <img src="https://picsum.photos/300/200?random=5" alt="森林图片" class="w-full h-48 object-cover rounded-lg mb-3">
                            <h3 class="font-bold text-lg">茂密森林</h3>
                            <p class="text-gray-600 text-sm">郁郁葱葱的森林，是地球上最重要的生态系统之一。</p>
                        </div>
                    </div>
                    
                    <!-- 底部 -->
                    <div class="bg-dark text-white p-4 text-center text-sm">
                        <p>已经到底啦！</p>
                    </div>
                </div>
            </div>
        </div>
        
        <p class="text-center text-gray-500 text-sm mt-6">
            在手机框架内触摸并滑动，体验模拟的滚动效果
        </p>
    </div>

    <script>
        // 等待DOM加载完成
        document.addEventListener('DOMContentLoaded', () => {
            // 获取元素
            const scrollContainer = document.getElementById('scrollContainer');
            const scrollContent = document.getElementById('scrollContent');
            
            // 滚动相关变量
            let startY = 0;          // 触摸开始时的Y坐标
            let currentY = 0;        // 当前内容的Y位置
            let isDragging = false;  // 是否正在拖动
            let animation = null;    // 存储动画实例
            let lastMoveTime = 0;    // 最后一次移动的时间
            let lastMoveY = 0;       // 最后一次移动的Y坐标
            let velocity = 0;        // 滚动速度
            
            // 计算内容和容器高度
            const containerHeight = scrollContainer.clientHeight;
            const contentHeight = scrollContent.scrollHeight;
            const maxScroll = containerHeight - contentHeight;  // 最大滚动距离（负值）
            
            // 触摸开始事件
            scrollContainer.addEventListener('touchstart', (e) => {
                // 停止任何正在进行的动画
                if (animation) {
                    animation.pause();
                }
                
                // 记录初始位置和时间
                startY = e.touches[0].clientY;
                isDragging = true;
                lastMoveTime = Date.now();
                lastMoveY = startY;
                velocity = 0;
                
                // 添加视觉反馈
                scrollContent.style.transition = 'none';
            }, { passive: true });
            
            // 鼠标按下事件（用于桌面测试）
            scrollContainer.addEventListener('mousedown', (e) => {
                if (animation) {
                    animation.pause();
                }
                
                startY = e.clientY;
                isDragging = true;
                lastMoveTime = Date.now();
                lastMoveY = startY;
                velocity = 0;
                
                scrollContent.style.transition = 'none';
            }, { passive: true });
            
            // 触摸移动事件
            scrollContainer.addEventListener('touchmove', (e) => {
                if (!isDragging) return;
                
                const currentTouchY = e.touches[0].clientY;
                const diff = currentTouchY - startY;
                let newY = currentY + diff;
                
                // 计算速度
                const currentTime = Date.now();
                const timeDiff = currentTime - lastMoveTime;
                if (timeDiff > 0) {
                    velocity = (currentTouchY - lastMoveY) / timeDiff;
                }
                
                // 更新最后移动的位置和时间
                lastMoveY = currentTouchY;
                lastMoveTime = currentTime;
                
                // 应用阻力效果（在边界外时）
                if (newY > 0) {
                    // 顶部边界外，添加阻力
                    newY = Math.pow(newY, 0.8);
                } else if (newY < maxScroll) {
                    // 底部边界外，添加阻力
                    const overshoot = newY - maxScroll;
                    newY = maxScroll - Math.pow(Math.abs(overshoot), 0.8);
                }
                
                // 更新位置
                scrollContent.style.transform = `translateY(${newY}px)`;
                startY = currentTouchY;
                currentY = newY;
            }, { passive: true });
            
            // 鼠标移动事件（用于桌面测试）
            document.addEventListener('mousemove', (e) => {
                if (!isDragging) return;
                
                const currentMouseY = e.clientY;
                const diff = currentMouseY - startY;
                let newY = currentY + diff;
                
                // 计算速度
                const currentTime = Date.now();
                const timeDiff = currentTime - lastMoveTime;
                if (timeDiff > 0) {
                    velocity = (currentMouseY - lastMoveY) / timeDiff;
                }
                
                // 更新最后移动的位置和时间
                lastMoveY = currentMouseY;
                lastMoveTime = currentTime;
                
                // 应用阻力效果
                if (newY > 0) {
                    newY = Math.pow(newY, 0.8);
                } else if (newY < maxScroll) {
                    const overshoot = newY - maxScroll;
                    newY = maxScroll - Math.pow(Math.abs(overshoot), 0.8);
                }
                
                // 更新位置
                scrollContent.style.transform = `translateY(${newY}px)`;
                startY = currentMouseY;
                currentY = newY;
            }, { passive: true });
            
            // 触摸结束事件
            scrollContainer.addEventListener('touchend', () => {
                finishScroll();
            }, { passive: true });
            
            // 鼠标释放事件（用于桌面测试）
            document.addEventListener('mouseup', () => {
                finishScroll();
            }, { passive: true });
            
            // 鼠标离开事件（用于桌面测试）
            document.addEventListener('mouseleave', () => {
                if (isDragging) {
                    finishScroll();
                }
            }, { passive: true });
            
            // 完成滚动，应用惯性
            function finishScroll() {
                isDragging = false;
                
                // 根据速度计算惯性滚动的目标位置
                const inertia = velocity * 100; // 惯性系数
                let targetY = currentY + inertia;
                
                // 限制在内容范围内
                if (targetY > 0) {
                    targetY = 0;
                } else if (targetY < maxScroll) {
                    targetY = maxScroll;
                }
                
                // 使用anime.js创建平滑的惯性滚动动画
                animation = anime({
                    targets: scrollContent,
                    translateY: [currentY, targetY],
                    duration: Math.abs(inertia) * 2, // 根据惯性距离调整动画时长
                    easing: 'easeOutQuad',
                    update: function(anim) {
                        currentY = anim.animations[0].currentValue;
                    }
                });
            }
        });
    </script>
</body>
</html>
